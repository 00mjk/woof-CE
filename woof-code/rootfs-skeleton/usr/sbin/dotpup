#!/bin/sh
#Lesser GPL licence v2 (http://www.fsf.org/licensing/licenses/lgpl.html)
#v3.02 Nov 2007 BK: updated. handle PET pkgs only.
#v3.99 apr2008 BK: run /usr/local/petget/pkg_chooser.sh instead of petget.
#v404 add choice of Universal Installer.
#w015 march 2009 BK: update for Woof.
#110402 added button to choose and install SFS file.
#110813 fixed package-management url.
#110814 01micko: convert script from gtkdialog2 to gtkdialog3+.
#110910 BK: get a syntax error with gtkdialog3 (patriot-e version), bump to gtkdialog4.
#120201 rodin.s: internationalized.

export TEXTDOMAINDIR=/usr/share/locale
export TEXTDOMAIN=dotpup
eval_gettext () {
  local myMESSAGE=$(gettext "$1")
  eval echo \"$myMESSAGE\"
}

. /etc/DISTRO_SPECS

export Puppy_Install='
<window title="'$(gettext 'Install')'">
<vbox space-expand="true" space-fill="true">
  <hbox space-expand="true" space-fill="true">
    <vbox space-expand="false" space-fill="false">
      '"`/usr/lib/gtkdialog/xml_pixmap info.svg icon`"'
    </vbox>
    <vbox>
      <text xalign="0" use-markup="true" space-expand="true" space-fill="true"><label>" '$(gettext "The word 'install' can mean two different things, either to")'"</label></text>
      <text xalign="0" use-markup="true" space-expand="true" space-fill="true"><label>" <b>1.)</b> '$(gettext "Install additional applications in the current Puppy.")'"</label></text>
      <text xalign="0" use-markup="true" space-expand="true" space-fill="true"><label>" <b>2.)</b> '$(gettext "Install Puppy to some other media.")'"</label></text>
      <text width-request="5" space-expand="false" space-fill="false"><label>""</label></text>
    </vbox>
  </hbox>

  <notebook labels="'$(gettext 'Install Puppy')'|'$(gettext 'Install applications')'">
    <vbox>
      '"`/usr/lib/gtkdialog/xml_info fixed puppy_install.svg 60 "$(gettext "Puppy can be installed to just about anything, including internal hard drive, USB drive and optical disc. If for example you are now running Puppy from live-CD and fancy booting Puppy off a USB Flash drive, this is the right place. There are two tools, the <b>Puppy Universal Installer (recommended)</b> and BootFlash, a specialised tool if you cannot get the computer to boot from a USB drive.")"`"'

      <hbox>
        <text><label>'$(gettext 'Puppy universal installer')'</label></text>
        <button>
          '"`/usr/lib/gtkdialog/xml_button-icon puppy_install.svg big`"'
          <action>/usr/sbin/puppyinstaller &</action>
        </button>
      </hbox>
      <hbox>
        <text><label>'$(gettext 'BootFlash USB installer')'</label></text>
        <button>
          '"`/usr/lib/gtkdialog/xml_button-icon puppy_install.svg big`"'
          <action>/usr/sbin/bootflash &</action>
        </button>
      </hbox>
    </vbox>

    <vbox>
      '"`/usr/lib/gtkdialog/xml_info fixed package_add.svg 60 "$(eval_gettext "The Puppy Package Manager is a tool for installing and uninstalling packages (applications). There are online repositories of ${DISTRO_BINARY_COMPAT} and Puppy packages -- the latter are known as PET packages and are identified by '.pet' on the end of their filename. Note that apart from the official ${DISTRO_BINARY_COMPAT} and PET repositories, Puppy enthusiasts have created many PETs at other locations, and all you need to do is download one and click on it to install it.")"`"'

      <hbox>
        <text><label>'$(gettext 'Puppy Package Manager')'</label></text>
        <button tooltip-text="PET Packages">
          '"`/usr/lib/gtkdialog/xml_button-icon package_add.svg big`"'
          <action>/usr/local/petget/pkg_chooser.sh &</action>
        </button>
      </hbox>
      <hbox>
        <text><label>'$(gettext 'Choose an SFS file from the official repo')'</label></text>
        <button tooltip-text="SFS Modular Packages">
          '"`/usr/lib/gtkdialog/xml_button-icon package_sfs.svg big`"'
          <action>/usr/sbin/sfsget &</action>
        </button>
      </hbox>
      <vbox space-expand="false" space-fill="false">
        <hbox space-expand="true" space-fill="true">
          <button space-expand="false" space-fill="false">
            '"`/usr/lib/gtkdialog/xml_button-icon help`"'
            <action>defaultbrowser http://puppylinux.com/development/package-management.htm & </action>
          </button>
          <text xalign="0" space-expand="true" space-fill="true"><label>'$(gettext 'Package Manager introduction webpage')'</label></text>
        </hbox>
      </vbox>
    </vbox>
  </notebook>

  <hbox space-expand="false" space-fill="false">
    <button>
      '"`/usr/lib/gtkdialog/xml_button-icon quit`"'
      <label>'$(gettext 'Quit')'</label>
    </button>
  </hbox>
</vbox>
</window>'

. /usr/lib/gtkdialog/xml_info gtk #build bg_pixmap for gtk-theme
gtkdialog -p Puppy_Install
echo "$Puppy_Install" > /root/test
