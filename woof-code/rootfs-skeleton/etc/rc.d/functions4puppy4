#some more functions called from boot scripts in Puppy4...
#w468 not using set_mixers() anymore, it's done in /etc/init.d/alsa.
#101120 new firmware_tarball_func, as /sbin/pup_event_backend_modprobe rewritten.
#110722 usb drive, LED light briefly flashes after unmounted, so wait a bit. 110828 remove.
#120828 rerwin: record firmware installed in /etc/modules/firmware.dep.inst.${KERNVER}
#120828 grep needs -E option, as expression is extended regular expression.
#120831 rerwin: Obtain firmware from all-firmware directories as well as tarballs.
#121004 rerwin: /etc/modules/firmware.dep.inst.${KERNVER} now has names of firmware tarballs, not modules.

pidof ROX-Filer &>/dev/null && ROX_DESKTOP=yes

#101119 called from rc.sysinit...

# new functions for xorg-udev
# keyboard
mk_keyboard_conf () {
	# used in keymap-set, xorgwizard-automatic
	# $1 = layout $2 = variant
	[ -z "$1" ] && LAYOUT=us || LAYOUT=$1
	[ -z "$2" ] && VARIANT="	#Option \"XkbVariant\" \"\" #put variant here" ||\
	VARIANT="	Option \"XkbVariant\" \"$2\" #put variant here"
	mkdir -p /etc/X11/xorg.conf.d
	cat > /etc/X11/xorg.conf.d/90-keyboard-layout.conf << _KEYS
Section "InputClass"
	Identifier "keyboard-all"
	MatchIsKeyboard "on"
	MatchDevicePath "/dev/input/event*"
	Driver "evdev"
	Option "XkbLayout" "$LAYOUT"
$VARIANT
	#Option "XkbModel" "pc104" #edit if needed
	Option "XkbOptions" "terminate:ctrl_alt_bksp"
EndSection

_KEYS

} # mk_keyboard_conf


###END###
